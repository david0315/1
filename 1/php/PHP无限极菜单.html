<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修PHP无限极菜单' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>PHP无限极菜单</center></div><div class='banquan'>原文出处:本文由博客园博主努力跟上大神的脚步提供。<br/>
原文连接:https://www.cnblogs.com/studyandstudy/p/11384438.html</div><br>
    <p>权限表结构</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">CREATE</span> <span style="color: #0000ff;">TABLE</span><span style="color: #000000;"> `blog_auth` (
  `id` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) unsigned <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> AUTO_INCREMENT COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">序号</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `pid` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL COMMENT '父级ID'</span><span style="color: #000000;">,
  `auth_name` </span><span style="color: #0000ff;">varchar</span>(<span style="color: #800000; font-weight: bold;">191</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">权限名字</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `auth_title` </span><span style="color: #0000ff;">varchar</span>(<span style="color: #800000; font-weight: bold;">191</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">权限标题</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `auth_icon` </span><span style="color: #0000ff;">varchar</span>(<span style="color: #800000; font-weight: bold;">191</span>) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">权限图标</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `auth_rule` </span><span style="color: #0000ff;">varchar</span>(<span style="color: #800000; font-weight: bold;">191</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">权限路径</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `menu` </span><span style="color: #0000ff;">tinyint</span>(<span style="color: #800000; font-weight: bold;">1</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">菜单  1=&gt;显示菜单，0=&gt;不显示菜单</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `debug` </span><span style="color: #0000ff;">tinyint</span>(<span style="color: #800000; font-weight: bold;">1</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">调试模式 1--&gt;仅调试模式显示，0--&gt;任何时候都显示</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `create_by` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">创建人</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `update_by` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">更新人</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `create_time` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">创建时间</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `update_time` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">更新时间</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `delete_time` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">删除时间</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `sort` </span><span style="color: #0000ff;">int</span>(<span style="color: #800000; font-weight: bold;">11</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">排序字段</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  `status` </span><span style="color: #0000ff;">tinyint</span>(<span style="color: #800000; font-weight: bold;">1</span>) <span style="color: #808080;">NOT</span> <span style="color: #0000ff;">NULL</span> COMMENT <span style="color: #ff0000;">'</span><span style="color: #ff0000;">状态</span><span style="color: #ff0000;">'</span><span style="color: #000000;">,
  </span><span style="color: #0000ff;">PRIMARY</span> <span style="color: #0000ff;">KEY</span><span style="color: #000000;"> (`id`) USING BTREE
) ENGINE</span><span style="color: #808080;">=</span>MyISAM AUTO_INCREMENT<span style="color: #808080;">=</span><span style="color: #800000; font-weight: bold;">23</span> <span style="color: #0000ff;">DEFAULT</span> CHARSET<span style="color: #808080;">=</span>utf8 ROW_FORMAT<span style="color: #808080;">=</span>DYNAMIC;</code></pre>

<p>相关代码</p>
<src class="cnblogs_code">
<pre><code> <span style="color: #008000;">/*</span><span style="color: #008000;">*
     * @title 菜单列表
     * @param int $uid
     * @return array
     * @throws \think\db\exception\DataNotFoundException
     * @throws \think\db\exception\ModelNotFoundException
     * @throws \think\exception\DbException
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">function</span> getMenuList(<span style="color: #800080;">$uid</span> = 0<span style="color: #000000;">)
    {</span><span style="color: #008000;">//</span><span style="color: #008000;">展示只有菜单类型的权限列表</span>
        <span style="color: #800080;">$auth_list_info</span> = Db::name('auth')-&gt;field(['id','pid','auth_title','auth_rule'])-&gt;<span style="color: #000000;">select();
        </span><span style="color: #0000ff;">if</span> (<span style="color: #800080;">$auth_list_info</span> === <span style="color: #0000ff;">null</span>){<span style="color: #0000ff;">return</span><span style="color: #000000;"> [];}
        </span><span style="color: #800080;">$auth_list_info</span> = <span style="color: #008080;">is_array</span>(<span style="color: #800080;">$auth_list_info</span>) ? <span style="color: #800080;">$auth_list_info</span> : <span style="color: #800080;">$auth_list_info</span>-&gt;<span style="color: #000000;">toArray();
        </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">$this</span>-&gt;getSonsInfo(<span style="color: #800080;">$auth_list_info</span><span style="color: #000000;">);
    }

    </span><span style="color: #008000;">/*</span><span style="color: #008000;">*
     * @title 菜单树生成
     * @param array $items - 数据
     * @param int $pid - 父级ID的值
     * @param int $deep - 深度
     * @return array
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">function</span> getSonsInfo(<span style="color: #0000ff;">array</span> <span style="color: #800080;">$items</span>,<span style="color: #800080;">$pid</span>=0,<span style="color: #800080;">$deep</span>=0<span style="color: #000000;">)
    {
        </span><span style="color: #800080;">$lists</span> =<span style="color: #000000;"> [];
        </span><span style="color: #0000ff;">foreach</span> (<span style="color: #800080;">$items</span> <span style="color: #0000ff;">as</span> <span style="color: #800080;">$item</span><span style="color: #000000;">){
            </span><span style="color: #0000ff;">if</span> (<span style="color: #800080;">$item</span>['pid'] === <span style="color: #800080;">$pid</span><span style="color: #000000;">){
                </span><span style="color: #800080;">$item</span>['deep'] = <span style="color: #800080;">$deep</span><span style="color: #000000;">;
                </span><span style="color: #800080;">$item</span>['son'] = <span style="color: #800080;">$this</span>-&gt;getSonsInfo(<span style="color: #800080;">$items</span>,<span style="color: #800080;">$item</span>['id'],<span style="color: #800080;">$deep</span>+1<span style="color: #000000;">);
                </span><span style="color: #800080;">$lists</span>[] = <span style="color: #800080;">$item</span><span style="color: #000000;">;
            }
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #800080;">$lists</span><span style="color: #000000;">;
    }</span></code></pre>

<p>打印结果</p>
<src class="cnblogs_code">
<pre><code><span style="color: #0000ff;">Array</span> ( [0] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 1 [pid] =&gt; 0 [auth_title] =&gt; 博客后台人员账户 [auth_rule] =&gt; backend/account/<span style="color: #0000ff;">default</span> [deep] =&gt; 0 [son] =&gt; <span style="color: #0000ff;">Array</span> ( [0] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 2 [pid] =&gt; 1 [auth_title] =&gt; 博客后台人员账户列表页 [auth_rule] =&gt; backend/account/index [deep] =&gt; 1 [son] =&gt; <span style="color: #0000ff;">Array</span> ( ) ) ) ) [1] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 9 [pid] =&gt; 0 [auth_title] =&gt; 博客后台首页 [auth_rule] =&gt; backend/index/<span style="color: #0000ff;">default</span> [deep] =&gt; 0 [son] =&gt; <span style="color: #0000ff;">Array</span> ( [0] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 10 [pid] =&gt; 9 [auth_title] =&gt; 博客后台首页 [auth_rule] =&gt; backend/index/index [deep] =&gt; 1 [son] =&gt; <span style="color: #0000ff;">Array</span> ( ) ) ) ) [2] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 19 [pid] =&gt; 0 [auth_title] =&gt; 博客后台文章管理 [auth_rule] =&gt; backend/article/<span style="color: #0000ff;">default</span> [deep] =&gt; 0 [son] =&gt; <span style="color: #0000ff;">Array</span> ( [0] =&gt; <span style="color: #0000ff;">Array</span> ( [id] =&gt; 20 [pid] =&gt; 19 [auth_title] =&gt; 博客后台文章列表页 [auth_rule] =&gt; backend/article/index [deep] =&gt; 1 [son] =&gt; <span style="color: #0000ff;">Array</span> ( ) ) ) ) )</code></pre>

<p>&nbsp;</p>

</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>