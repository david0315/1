<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修PHP全栈学习笔记4' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>PHP全栈学习笔记4</center></div><div class='banquan'>原文出处:本文由博客园博主达达前端小酒馆提供。<br/>
原文连接:https://www.cnblogs.com/dashucoding/p/10730900.html</div><br>
    <p><img src="./images/PHP全栈学习笔记40.jpg" alt="PHP全栈学习笔记4" /></p>
<blockquote>
<p>php和JavaScript，掌握JavaScript基础，自定义函数，流程控制语句，事件，调用JavaScript脚本，在PHP中使用JavaScript。</p>
</blockquote>
<p>JavaScript是网景公司开发的，是一种基于对象和事件驱动并具有安全性能的解释型脚本语言。</p>
<p>JavaScript基础，数据类型，变量，注解</p>
<p>数据类型，unll，undefined，对象型，布尔型，数值型，字符串型。</p>
<p>变量，指在程序中已经存在的命名存储单元，存放信息的容器。</p>
<pre><code><code>abstract, continue, finally, instanceof, private, this
class, final, in, package, synchronized, with
char, false, import, null, switch, while
catch, extends, implements, new, super, void
case, else, goto, native, static, var
byte, double, function, long, short, true
break, do, for, interface, return, typeof
boolean, default, float, int, public, throw</code></code></pre>
<p>自定义函数</p>
<pre><code><code>function 函数名([参数]){
    return var;
}
函数名();</code></code></pre>
<p>流程控制语句：</p>
<p>条件语句</p>
<pre><code><code>if(条件表达式){
      语句块
 }

if(条件表达式)
    {
         语句块1;
    } 
    else
    {
         语句块2;
    }

switch(表达式或变量){
case 常量表达式1:
     语句块1;
     break;

case常量表达式2:
     语句块2;
     break;
      …
case常量表达式n:
    语句块n;
    break;
  
 default:
    语句块n+1;
    break;
} </code></code></pre>
<pre><code><code>&lt;script language=&quot;javascript&quot;&gt;
function check(){
var year1 = form.year.value;
 if((year1%4==0&amp;&amp;(year1%100)!=0){}
}
&lt;/script&gt;</code></code></pre>
<p>循环语句</p>
<pre><code><code>while(条件表达式){
    语句块
}

 for (初始化循环变量;循环条件;确定循环变量的改变值){
    语句块;
 }</code></code></pre>
<p>跳转语句，break语句终止循环，continue语句跳出本次循环，进入下一次循环。</p>
<h2 id="事件">事件</h2>
<pre><code><code>onclick 鼠标点击事件
ondblclick 鼠标双击事件
onmousedown 鼠标按下事件
onmouseup 鼠标按下后松开事件
onmouseover 鼠标移动到某对象上方事件
onmousemove 鼠标移动时触发事件
onkeypress 键盘按下且释放事件
onkeydown 键盘按下事件
onkeyup 键盘按下后松开时触发的事件

onabort 图片在下载时被用户中断时触发
onload 页面内容完成时触发
onresize 浏览器窗口大小被改变
onunload 当前页面将被改变时触发此事件

onblur 失去焦点
onchange 内容发生改变
onfocus 获取焦点
onreset 和 onsubmit</code></code></pre>
<p>嵌入JavaScript脚本</p>
<pre><code><code>&lt;script language=&quot;javascript&quot;&gt;
…
&lt;/script&gt;

&lt;input type=&quot;submit&quot; name=&quot;Submit&quot; value=&quot;检测&quot; onClick=&quot;check();&quot;&gt;

&lt;script src＝url  language=&quot;Javascript&quot;&gt;&lt;/script&gt;</code></code></pre>
<pre><code><code>&lt;script language=&quot;javascript&quot;&gt;
function check(){
if(myform.subject.value==&quot;&quot;){
    alert(&quot;文章主题不能为空！！&quot;);myform.subject.focus();return false;
    }
if(myform.content.value==&quot;&quot;){
    alert(&quot;文章内容不能为空！！&quot;);myform.content.focus();return false;
    }
if(myform.author.value==&quot;&quot;){
    alert(&quot;作者不能为空！！&quot;);myform.author.focus();return false;
    }
alert(&quot;成功通过验证！&quot;);
}
&lt;/script&gt;</code></code></pre>
<blockquote>
<p>系统时区设置，PHP日期和时间函数，应用</p>
</blockquote>
<p><img src="./images/PHP全栈学习笔记41.jpg" alt="image.png" /></p>
<p><img src="./images/PHP全栈学习笔记42.jpg" alt="image.png" /></p>
<p>mktime()函数将一个时间转换成UNIX的时间戳值</p>
<pre><code><code>int mktime(int hour, int minute, int second, int month, int day, int year, int [is_dst] )</code></code></pre>
<pre><code><code>hour 小时数， minute 分钟数，second秒数，month月份数，day天数，year年份数，is_dst在夏令时设置为1，不是为0，不确定为-1</code></code></pre>
<p>获取时间戳</p>
<pre><code><code>int time ( void )</code></code></pre>
<p>获取当前日期和时间</p>
<pre><code><code>date(string format,int timestamp)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记43.jpg" alt="image.png" /></p>
<p>获取日期信息</p>
<pre><code><code>array getdate(int timestamp)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记44.jpg" alt="image.png" /></p>
<p>检验日期的有效性</p>
<pre><code><code>bool checkdate(int month,int day,int year)</code></code></pre>
<p>输出格式化的日期和时间<br />
<img src="./images/PHP全栈学习笔记45.jpg" alt="image.png" /></p>
<pre><code><code>Y-m-d H:i:s</code></code></pre>
<p>显示本地化的日期和时间<br />
setlocale()函数设置本地化环境<br />
strftime()函数格式化输出日期和时间</p>
<pre><code><code>string setlocale(string category, string locale)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记46.jpg" alt="image.png" /></p>
<pre><code><code>string strftime(string format, int timestamp)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记47.jpg" alt="image.png" /></p>
<p><img src="./images/PHP全栈学习笔记48.jpg" alt="image.png" /></p>
<p>将日期和时间解析为UNIX时间戳</p>
<pre><code><code>int strtotime ( string time [, int now] ) 将任何英文文本的日期和时间解析为UNIX时间戳</code></code></pre>
<p><img src="./images/PHP全栈学习笔记49.jpg" alt="image.png" /></p>
<p>比较时间，要将时间解析为时间戳，strtotime()函数</p>
<pre><code><code>&lt;?php
    $time1 = date(&quot;Y-m-d H:i:s&quot;);
    $time2 = &quot;2006-6-6 10:30:00&quot;;
    echo &quot;变量1的时间为：&quot;.$time1.&quot;&lt;br&gt;&quot;;
    echo &quot;变量2的时间为：&quot;.$time2.&quot;&lt;p&gt;&quot;;
    if(strtotime($time1) - strtotime($time2) &lt; 0){
        echo &quot;\$time1 早于 \$time2 &quot;;
    }else{
        echo &quot;\$time2 早于 $time1 &quot;;
    }
?&gt;</code></code></pre>
<pre><code><code>&lt;?PHP 
     $time1 = strtotime(date( &quot;Y-m-d H:i:s&quot;));
     $time2 = strtotime(&quot;2010-5-2 12:10:00&quot;);
     $time3 = strtotime(&quot;2014-2-4&quot;);
     $sub1 = ceil(($time2 - $time1) / 3600);            //60 * 60
     $sub2 = ceil(($time3 - $time1) / 86400);           //60 * 60 * 24
     echo &quot;离放假还有$sub1 小时!!!&quot; ;  
     echo &quot;&lt;p&gt;&quot;;
     echo &quot;离元旦还有$sub2 天!!!&quot;;
?&gt; </code></code></pre>
<p>计算页面脚本的运行时间</p>
<pre><code><code>string microtime(void)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记410.jpg" alt="image.png" /></p>
<p><img src="./images/PHP全栈学习笔记411.jpg" alt="image.png" /></p>
<p>利用cookie来区别不同用户</p>
<p>Cookie是一种在远程浏览器端存储数据并以此来跟踪和识别用户的机制。</p>
<p>文本文件的命令格式如下：<br />
用户名@网站地址[数字].txt</p>
<p><img src="./images/PHP全栈学习笔记412.jpg" alt="image.png" /></p>
<p>创建cookie:</p>
<pre><code><code>bool setcookie(string name[,string value[,int expire[, string path[,string domain[,int secure]]]]])</code></code></pre>
<p><img src="./images/PHP全栈学习笔记413.jpg" alt="image.png" /></p>
<pre><code><code>&lt;?php
setcookie(&quot;TMCookie&quot;,&quot;www.dashucoding.cn&quot;);
setcookie(&quot;TMCookie&quot;,&quot;www.dashucoding.cn&quot;, time()+60);
// 有效时间设置 60秒，目录&quot;/tm/&quot;, 域名
setcookie(&quot;TMCookie&quot;, $value, time() + 3600, &quot;/tm/&quot;, &quot;.dashucoding.cn&quot;, 1);
?&gt;</code></code></pre>
<p>读取cookie</p>
<pre><code><code>&lt;?php
if(!isset($_COOKIE[&quot;visittime&quot;])){
 setcookie(&quot;visittime&quot;,date(&quot;y-m-d H:i:s&quot;));
 echo &quot;欢迎第一次&quot;;
}else{
 setcookie(&quot;visittime&quot;,date(&quot;y-m-d H:i:s&quot;), time()+60);
 echo &quot;上次访问&quot;.$_COOKIE[&quot;visittime&quot;];
 echo &quot;&lt;br&gt;&quot;
}
echo &quot;本次访问&quot;.date(&quot;y-m-d H:i:s&quot;);
?&gt;</code></code></pre>
<p>删除cookie:使用setcookie()函数删除，手动删除（在浏览器中手动删除Cookie）</p>
<pre><code><code>setcookie(&quot;name&quot;,&quot;&quot;, time()-1);</code></code></pre>
<p>浏览器最多允许存储300个Cookie文件，每个Cookie文件支持最大容量为4KB，每个域名最多支持20个Cookie。</p>
<p><img src="./images/PHP全栈学习笔记414.jpg" alt="image.png" /></p>
<p><img src="./images/PHP全栈学习笔记415.jpg" alt="image.png" /></p>
<p>启动会话→注册会话→使用会话→删除会话</p>
<p>session_start ()函数创建会话：</p>
<pre><code><code>bool session_start(void)</code></code></pre>
<p>通过session_register()函数创建会话用来为会话创建一个变量来隐含地启动会话。使用这个函数，不用调用session_start()函数，因为hi隐含地调用session_start()函数。</p>
<p>注册会话：</p>
<pre><code><code>&lt;?php 
session_start();    //启动Session             
$_SESSION[&quot;admin&quot;] = null; //声明一个名为admin的变量，并赋空值    
?&gt;</code></code></pre>
<p>使用会话:</p>
<pre><code><code>&lt;?php
if ( !empty ( $_SESSION[&#39;session_name&#39;]))   //判断用于存储用户名的Session会话变量是否为空
     $myvalue = $_SESSION[&#39;session_name&#39;] ;//将会话变量赋给一个变量$myvalue
?&gt;

if (! isset ( $_SESSION )) {
    session_start ();
}
if (! isset ( $_SESSION [&#39;userName&#39;] )) {
    header ( &quot;location:login.php&quot; );
}
$userName = $_SESSION [&#39;userName&#39;];</code></code></pre>
<p>删除会话<br />
删除单个会话、删除多个会话和结束当前会话</p>
<p>删除单个会话</p>
<pre><code><code>unset ( $_SESSION[&#39;user&#39;] ) ;</code></code></pre>
<p>删除多个会话</p>
<pre><code><code>$_SESSION = array() ;</code></code></pre>
<p>结束当前会话</p>
<pre><code><code>session_destroy() ;</code></code></pre>
<blockquote>
<p>Session设置时间</p>
</blockquote>
<p>使用session_set_cookie_params()设置Session的失效时间<br />
使用setcookie()函数可对Session设置失效时间</p>
<pre><code><code>&lt;?php
$time = 1*60;
session_set_cookie_params($time);
session_start();
$_SESSION[username] = &quot;mr&quot;
?&gt;</code></code></pre>
<pre><code><code>&lt;?php
session_start();
$time=1*60;
setcookie(session_name(), session_id(), time()+$time,&quot;/&quot;);
$_SESSION[&#39;user&#39;]=&#39;mr&#39;;
?&gt;</code></code></pre>
<p>客户端禁止Cookie:</p>
<pre><code><code>设置php.ini文件中的session.use_trans_sid = 1
编译时打开-enable-trans-sid选项，让PHP自动跨页面传递session_id
隐藏表单传递session_id</code></code></pre>
<pre><code><code>&lt;form id=&quot;form1&quot; name=&quot;form1&quot; method=&quot;post&quot; action=&quot;xx.php?&lt;?=session_name();?&gt;=&lt;?=session_id();?&gt;&quot;&gt;

&lt;?php
$sess_name = session_name();
$sess_id = $_GET[$sess_name];
session_id($sess_id);
session_start();
$_SESSION[&#39;admin&#39;]=&#39;mr&#39;;
?&gt;</code></code></pre>
<p>页面a传值到页面b:</p>
<p><img src="./images/PHP全栈学习笔记416.jpg" alt="image.png" /></p>
<p>页面a传值给页面b,页面c,页面d等，，，如何做？</p>
<p><img src="./images/PHP全栈学习笔记417.jpg" alt="image.png" /></p>
<p>但是用cookie不安全，如果有人修改就非常危险了。</p>
<p><img src="./images/PHP全栈学习笔记418.jpg" alt="image.png" /></p>
<p>加密。使用哈希函数MD5：<br />
MD5（uid+一个固定的随机的字符串）</p>
<pre><code><code>if (! isset ( $_SESSION )) {
    session_start ();
}
if (! isset ( $_SESSION [&#39;userName&#39;] )) {
    header ( &quot;location:login.php&quot; );
}
$userName = $_SESSION [&#39;userName&#39;];</code></code></pre>
<p>登录划分</p>
<pre><code><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=gb2312&quot;&gt;
&lt;title&gt;博客用户登录&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
.style1 {color: #FF0000}
--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script language=&quot;javascript&quot;&gt;
    function check(form){
        if(form.user.value==&quot;&quot;){
            alert(&quot;请输入用户名&quot;);form.user.focus();return false;     
        }
        if(form.pwd.value==&quot;&quot;){
            alert(&quot;请输入密码&quot;);form.pwd.focus();return false;
        }
        form.submit();
    }
&lt;/script&gt;
&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;default.php&quot;&gt;
  &lt;table width=&quot;521&quot; height=&quot;394&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;
    &lt;tr&gt;
      &lt;td valign=&quot;top&quot; background=&quot;images/login.jpg&quot;&gt;&lt;table width=&quot;521&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
          &lt;tr&gt;
            &lt;td width=&quot;262&quot; height=&quot;218&quot;&gt;&amp;nbsp;&lt;/td&gt;
            &lt;td width=&quot;259&quot;&gt;&amp;nbsp;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td height=&quot;24&quot; align=&quot;right&quot;&gt;用户名：&lt;/td&gt;
            &lt;td height=&quot;24&quot; align=&quot;left&quot;&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; id=&quot;user&quot; size=&quot;20&quot;&gt;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td height=&quot;24&quot; align=&quot;right&quot;&gt;密&amp;nbsp;&amp;nbsp;码：&lt;/td&gt;
            &lt;td height=&quot;24&quot; align=&quot;left&quot;&gt;&lt;input name=&quot;pwd&quot; type=&quot;password&quot; id=&quot;pwd&quot; size=&quot;20&quot;&gt;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr align=&quot;center&quot;&gt;
            &lt;td height=&quot;24&quot; colspan=&quot;2&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;Submit&quot; value=&quot;提交&quot; onClick=&quot;return check(form);&quot;&gt;
            &amp;nbsp;&amp;nbsp;
            &lt;input type=&quot;reset&quot; name=&quot;Submit2&quot; value=&quot;重填&quot;&gt;&lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td height=&quot;76&quot; align=&quot;right&quot;&gt;&lt;span class=&quot;style1&quot;&gt;超级用户：tsoft&lt;br&gt;
  密&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;码：111&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;
            &lt;td&gt;&lt;span class=&quot;style1&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;普通用户：zts&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;密&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;码：000&lt;/span&gt;&lt;/td&gt;
          &lt;/tr&gt;
      &lt;/table&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></code></pre>
<pre><code><code>&lt;?php
session_start();
$_SESSION[user]=$_POST[user];
$_SESSION[pwd]=$_POST[pwd];
if($_SESSION[user]==&quot;&quot;){
  echo &quot;&lt;script language=&#39;javascript&#39;&gt;alert(&#39;请通过正确的途径登录本系统！&#39;);history.back();&lt;/script&gt;&quot;;
}
?&gt;

&lt;?php if($_SESSION[user]==&quot;123&quot; &amp;&amp; $_SESSION[pwd]==&quot;123456&quot;){echo &quot;管理员&quot;;}else{echo &quot;普通用户&quot;;}?&gt;</code></code></pre>
<pre><code><code>&lt;a href=&quot;safe.php&quot;&gt;注销用户&lt;/a&gt;

&lt;?php
session_start();
unset($_SESSION[&#39;user&#39;]);
unset($_SESSION[&#39;pwd&#39;]);
session_destroy();
header(&quot;location:index.php&quot;);
?&gt;</code></code></pre>
<p>Session高级应用</p>
<p>session是将session的信息保存在服务器上，通过session id来传递客户端的信息，同时服务器接收到session id后，根据这个id来提供相关的session信息资源。</p>
<p>cookie是将信息以文本文件的形式保存在客户端，通过浏览器进行管理和维护。</p>
<p>如果将session保存到临时目录中，会降低服务器的安全性和效率，使用session_save_path()函数解决session临时文件问题。</p>
<pre><code><code>&lt;?php
$path=&quot;./tmp/&#39;;
session_save_path($path);
session_start();
$_SESSION[username]=true;
?&gt;</code></code></pre>
<p>Session缓存</p>
<pre><code><code>string session_cache_limiter ( [string cache_limiter])</code></code></pre>
<pre><code><code>int session_cache_expire ( [int new_cache_expire])</code></code></pre>
<blockquote>
<p>cookie和session区别和小结</p>
</blockquote>
<p>cookie是通过扩展http协议实现的，主要包括有名字，值，过期时间，路径和域。如果cookie不设置时间，就以浏览器关闭而关闭，cookie一般存储在内存中，不是在硬盘上，设置了时间，不随浏览器的关闭而消失，cookie仍然有效到超过设定的过期时间。</p>
<p>session和session id，保存session id的方式可以采用cookie，cookie数据存放在浏览器上，session数据放在服务器上，cookie不安全，session安全，session会在一定时间内保存在服务器上，访问多了，会占用服务器的性能，考虑到减轻服务器性能，应该使用cookie。</p>
<p>浏览器最多允许存储300个cookie文件，每个cookie文件最多保存数据不能超过4kb，很多浏览器都限制一个站点最多保存20个cookie，每个域名最多支持20个cookie。如果超过，浏览器会自动删除cookie文件。</p>
<p>登录信息等重要信息保存在session中，不重要的保存在cookie中。保存在session中，很容易丢失，所以要结合cookie中，当session丢失时，如果cookie还在我们设定的有效期内，就可以再一次从cookie中取出值放进session里，</p>
<pre><code><code>&lt;sessionState timeout=&quot;5&quot; mode=&quot;InProc&quot; /&gt;

&lt;sessionState timeout=&quot;2&quot; mode=&quot;StateServer&quot; /&gt;

cookie有效期的设置

httpCookie.Expires = DateTime.Now.AddMinutes(2);

是否有权限访问该网页

if (Request.Cookies[&quot;httpCookie&quot;] != null)
{
Session[&quot;admin&quot;] = Request.Cookies[&quot;httpCookie&quot;].Values[&quot;admin&quot;].ToString();
}
if (Session[&quot;admin&quot;] == null)
{
this.ClientScript.RegisterStartupScript(this.GetType(), &quot;&quot;, &quot;&lt;script&gt;alert(&#39;请重新登 录&#39;);location.href=&#39;logins.aspx&#39;&lt;/script&gt;&quot;);
}</code></code></pre>
<p>PHP禁用Cookie之后Session还能用吗？能。<br />
在登录之前提醒用户必须打开cookie。<br />
设置php.ini配置文件中的“session.use_trans_sid = 1”，或者编译时打开打开了“--enable-trans-sid”选项，让PHP自动跨页传递Session ID。<br />
手动通过URL传值，隐藏表单传递Session ID。<br />
用文件、数据库等形式保存Session ID，在跨页过程中手动调用。</p>
<blockquote>
<p>COOKIE和SESSION的使用</p>
</blockquote>
<p>创建cookie值：</p>
<pre><code><code>//  函数设置Cookie
Setcookie(&quot;标识键值&quot;,&quot;Cookie值&quot;,&quot;有效时间&quot;,&quot;有效作用域 / 表示当前网站下好使&quot;);
 
//  赋值设置Cookie
$_COOKIE[&#39;标识键值&#39;] = &quot;Cookie值&quot;;</code></code></pre>
<p>修改Cookie值:</p>
<pre><code><code>//  函数设置Cookie
Setcookie(&quot;标识键值&quot;,&quot;Cookie新值&quot;,&quot;新有效时间&quot;,&quot;新的有效作用域&quot;);
 
//  赋值设置Cookie
$_COOKIE[&#39;标识键值&#39;] = &quot;Cookie新值&quot;;</code></code></pre>
<p>删除cookie值：</p>
<pre><code><code>//  函数设置Cookie
Setcookie(&quot;标识键值&quot;,&quot;空值&quot;,time()-1);</code></code></pre>
<p>查看Cookie值:</p>
<pre><code><code>//  查看所有Cookie值
var_dump($_COOKIE);
 
//  查看具体的Cookie值
var_dump($_COOKIE[&#39;键值&#39;]);</code></code></pre>
<p>举例:</p>
<pre><code><code>&lt;?php
    // 增加 Cookie
 
    // 设置Cookie函数法 setCookie();
    setCookie(&quot;test1&quot;,&quot;test1&quot;);
    // 设置Cookie赋值法
    $_COOKIE[&#39;test2&#39;] = &quot;test2&quot;;
 
    // 修改Cookie
 
    // 修改Cookie setCookie()
    setCookie(&quot;test1&quot;,&quot;test1-&gt;test3&quot;);
    // 修改Cookie赋值法
    $_COOKIE[&quot;test2&quot;] = &quot;test2-&gt;test4&quot;;
 
 
    // 查询所有Cookie值
    var_dump($_COOKIE);
 
    // 查询键值为test2的值
    var_dump($_COOKIE[&#39;test2&#39;]);
 
    // 删除键值为test1的值
    setCookie(&quot;test1&quot;,&quot;&quot;,time()-1);
 
    // 设置test2值为空
    $_COOKIE[&#39;test2&#39;] = &quot;&quot;;
 
    var_dump($_COOKIE);</code></code></pre>
<p>使用setcookie设置或修改cookie后，第一次刷新页面打印cookie不会有结果，只会生成cookie文件，第二次刷新时才有获取新增或修改的值，使用$_COOKIE新增或修改值，在修改后第一次请求就可以获取结果。</p>
<p>使用setcookie删除cookie值时，第一次删除只是删除了文件，刷新页面后，对应的cookie值已经被删除。</p>
<p>所有setcookie函数作用第一次不会产生结果，第二次才会，使用$_COOKIE操作的数据第一次就会了。</p>
<h2 id="session会话控制">SESSION会话控制</h2>
<p>session内容一般以文件的形式存储于服务器中，Cookie存储的是键值为“PHPSESSID”的Seeion_id值，一般服务器存储的session文件也会在30分钟后自动清除。</p>
<p>添加session:</p>
<pre><code><code>$_SESSION[&#39;session键值&#39;] = &quot;session值&quot;;</code></code></pre>
<p>修改session:</p>
<pre><code><code>$_SESSION[&#39;session键值&#39;] = &quot;session新值&quot;;</code></code></pre>
<p>查看session值:</p>
<pre><code><code>// 查看全部session
var_dump($_SESSION);
// 单独查看键值
var_dump($_SESSION[&#39;test&#39;]);</code></code></pre>
<p>删除session:</p>
<pre><code><code>// 删除session值，但保留数据类型
$_session[&#39;session键值&#39;] = array();
 
// 删除cookie中的session_id
$session_id = session_name();
setCookie($session_id,&quot;&quot;,time()-1);
 
// 释放当前在内存中已经创建的所有$_SESSION变量
session_unset();
 
// 删除当前用户对应的session文件以及释放session_id
session_destroy();</code></code></pre>
<p>使用举例:</p>
<pre><code><code>&lt;?php
    // 开启session
    session_start();
 
    // 增加session
    $_SESSION[&#39;test&#39;] = &quot;session内容&quot;;
    $_SESSION[&#39;test1&#39;] = &quot;session内容&quot;;
    // var_dump($_SESSION[&#39;test&#39;]);
 
    // 修改session
    $_SESSION[&#39;test&#39;] = &quot;session修改内容&quot;;
    // var_dump($_SESSION[&#39;test&#39;]);
 
    // 查看全部session
    var_dump($_SESSION);
 
    // 单独查看键值为test的Session值
    var_dump($_SESSION[&#39;test&#39;]);
 
    // 删除session
 
    // 删除session的变量值
    // $_SESSION[&#39;test&#39;] = array();
 
    // 删除所有的SESSION一般用于退出操作
 
    // 1使客户端COOKIE中的SESSIONID过期
    // $session_id = Session_name();
    // setcookie($session_id,&quot;&quot;,time()-1);
 
    // 释放当前在内存中已经创建的所有$_SESSION变量，但不删除session文件以及不释放对应的session_id
    // session_unset();
 
    // 删除当前用户对应的session文件以及释放session_id，但内存中的$_SESSION变量内容依然保留
    session_destroy();
 
    var_dump($_SESSION);</code></code></pre>
<p>cookie和session区别：<br />
存储位置，数量和大小限制，内容区别，路径区别<br />
session值没有大小的限制，但过多，会导致服务器压力大，内容，cookie保存的是字符串，session保存的数据是对象</p>
<p><img src="./images/PHP全栈学习笔记419.jpg" alt="image.png" /></p>
<blockquote>
<p>session 实现，存储</p>
</blockquote>
<p><img src="./images/PHP全栈学习笔记420.jpg" alt="image.png" /></p>
<p>session_id获取/设置当前会话 ID</p>
<pre><code><code>session_id ([ string $id ] ) : string</code></code></pre>
<blockquote>
<p>php中的cookie使用</p>
</blockquote>
<p>cookie是保存在客户端浏览器中的，cookie是http头的一部分，通过浏览器请求页面时，通过http头的形式发送过去，被请求的页面时，通过PHP来获取cookie的值。</p>
<p>设置cookie:</p>
<pre><code><code>bool setcookie( string name,[string value],[int expire],[string path],[string domain]);</code></code></pre>
<p>name:为cookie名<br />
value:为cookie值<br />
expire:为过期时间<br />
path为服务器端有效路径<br />
domain:为cookie有效的域名</p>
<p>实例：</p>
<pre><code><code>setcookie(&#39;text&#39;,&#39;text&#39;,time()+3600*12,&#39;/&#39;,&#39;www.test.com&#39;);</code></code></pre>
<p>获取cookie:</p>
<pre><code><code>$cookieValue =&#39;&#39;;

if (isset($_COOKIE[&#39;text&#39;]))   //首先判断是否已设置了该cookie
{
    $cookieValue = $_COOKIE[&#39;text&#39;];
}</code></code></pre>
<p>销毁cookie:</p>
<pre><code><code>setcookie(&quot;user&quot;, &quot;&quot;, time()-3600);</code></code></pre>
<p>小结：</p>
<p><img src="./images/PHP全栈学习笔记421.jpg" alt="image.png" /></p>
<p><img src="./images/PHP全栈学习笔记422.jpg" alt="image.png" /></p>
<blockquote>
<p>Session高级应用</p>
</blockquote>
<p>session临时文件，session缓存，session数据库存储<br />
临时文件session_save_path()存储session临时文件，可以缓解临时文件存储导致服务器效率降低等问题。</p>
<pre><code><code>&lt;?php
$path=&quot;./tmp/&quot;;
session_save_path($path);
session_start();
$_SESSION[username] = true;
?&gt;</code></code></pre>
<p>Session缓存<br />
Session缓存的完成使用的是session_cache_limiter()函数</p>
<pre><code><code>string session_cache_limiter ( [string cache_limiter])</code></code></pre>
<p>session_cache_expire()函数，缓存时间的设置</p>
<pre><code><code>int session_cache_expire ( [int new_cache_expire])</code></code></pre>
<p>实例：</p>
<pre><code><code>&lt;?php
session_cache_limiter(&#39;private&#39;);
$cache_limit = session_cache_limiter(); // 开启客户端缓存
session_cache_expire(30);
$cache_expire = session_cache_expire(); // 设置客户端缓存时间
session_start();
?&gt;</code></code></pre>
<p>Session数据库存储<br />
PHP中的session_set_save_handler()函数</p>
<pre><code><code>bool session_set_save_handler ( string open, string close, string read, string write, string destroy, string gc)</code></code></pre>
<p><img src="./images/PHP全栈学习笔记423.jpg" alt="image.png" /></p>
<p>封装session_open()函数，连接数据库</p>
<pre><code><code>function _session_open($save_path,$session_name)
{
     global $handle;
     $handle = mysql_connect(&#39;localhost&#39;,&#39;root&#39;,&#39;root&#39;) or die(&#39;数据库连接失败&#39;);      //连接MySQL数据库
     mysql_select_db(&#39;db_database11&#39;,$handle) or die(&#39;数据库中没有此库名&#39;);      //找到数据库
     return(true);
}</code></code></pre>
<p>封装session_close()函数，关闭数据库连接</p>
<pre><code><code>function _session_close()
{
    global $handle;
    mysql_close($handle);
    return(true);
} </code></code></pre>
<p>封装session_read()函数</p>
<pre><code><code>function _session_read($key)
{
    global $handle; //全局变量$handle连接数据库
    $time = time();      //设定当前时间   
    $sql = &quot;select session_data from tb_session where session_key = &#39;$key&#39; and session_time &gt; $time&quot;;
    $result = mysql_query($sql,$handle);
    $row = mysql_fetch_array($result);
    if ($row){
        return($row[&#39;session_data&#39;]);           //返回Session名称及内容
    }else{
        return(false);
    }
}</code></code></pre>
<p>封装session_write()函数</p>
<pre><code><code>function _session_write($key,$data)
{
    global $handle;
    $time = 60*60;   //设置失效时间
    $lapse_time = time() + $time; //得到UNIX时间戳           $sql = &quot;select session_data from tb_session where session_key = &#39;$key&#39; and session_time &gt; $lapse_time&quot;;
    $result = mysql_query($sql,$handle);
    if (mysql_num_rows($result) == 0 ) {    //没有结果
    $sql = &quot;insert into tb_session values(&#39;$key&#39;,&#39;$data&#39;,$lapse_time)&quot;;//插入数据库sql语句
        $result = mysql_query($sql,$handle);
    }else{
        $sql = &quot;update tb_session set session_key = &#39;$key&#39;,session_data = &#39;$data&#39;,session_time = $lapse_time where session_key = &#39;$key&#39;&quot;;    //修改数据库sql语句       $result = mysql_query($sql,$handle);
    }
    return($result);
} </code></code></pre>
<p>封装session_destroy()函数</p>
<pre><code><code>function _session_destroy($key)
{
    global $handle;
    $sql = &quot;delete from tb_session where session_key = &#39;$key&#39;&quot;;         //删除数据库sql语句
    $result = mysql_query($sql,$handle);
    return($result);
}</code></code></pre>
<p>封装session_gc()函数</p>
<pre><code><code>function _session_gc($expiry_time)
{
    global $handle;
    $lapse_time = time();                       //将参数$expiry_time赋值为当前时间戳
    $sql = &quot;delete from tb_session where expiry_time &lt; $lapse_time&quot;;    //删除数据库sql语句
    $result = mysql_query($sql,$handle);
    return($result);
}</code></code></pre>
<h2 id="结言">结言</h2>
<p>好了，欢迎在留言区留言，与大家分享你的经验和心得。</p>
<p>感谢你学习今天的内容，如果你觉得这篇文章对你有帮助的话，也欢迎把它分享给更多的朋友，感谢。</p>
<p>感谢！承蒙关照！您真诚的赞赏是我前进的最大动力！</p>
<p><img src="//upload-images.jianshu.io/upload_images/11158618-da750878d19e7fa1?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image" /></p>
<p><img src="//upload-images.jianshu.io/upload_images/11158618-826395d4148483a1?imageMogr2/auto-orient/strip" alt="image" /></p>


</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>