<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修用Swoole+React 实现的聊天室' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>用Swoole+React 实现的聊天室</center></div><div class='banquan'>原文出处:本文由博客园博主程序媛的明天提供。<br/>
原文连接:https://www.cnblogs.com/a609251438/p/11918643.html</div><br>
    <p>前后端分离的项目，使用 Swoole+React 实现的聊天室，整个项目的框架结构可以进行参考，前端 react+react-redux+react-router+react-ant 等等，后台使用 easySwoole，自行实现中间件（数据封装，token 验证，签名验证), 认真看代码可以学到很多哦，?！</p>
<h3>1. 项目链接</h3>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>1.1 swoole（请 star）</h3>
<p><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/LaravelChen/swoole_chat_framework" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">https://github.com/LaravelChen/swoole_chat...</a></p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>1.2 react（请 star）</h3>
<p><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/LaravelChen/React-Small-Chat" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">https://github.com/LaravelChen/React-Small...</a></p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>1.3 api 框架 (基本需求已全部实现，可以自己试试？)</h3>
<p><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/LaravelChen/swoole_api_framework" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">https://github.com/LaravelChen/swoole_api_...</a><br />性能展示 (强，强，强)</p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<p><img src="./images/用Swoole+React 实现的聊天室0.jpg" alt="" /></p>
<h3>2. 简介</h3>
<p>本人为了更加便利的开发，自行实现了中间件，封装了请求数据体，利用 jwt 实现 api 的 token 验证，集成了 Laravel 的 ORM，再次封装了一套适合 api 编写流程的数据请求流程，具体可以看 App/Base 目录下的 Model 类，具体开发步骤详见代码即可。</p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>3. 主要实现</h3>
<ul>
<li>登录注册，验证码发送（如果需要测试，可以结合前端 react 将验证码打印出来即可）</li>
<li>公共聊天室（一旦用户登录，用户列表即会增加，该用户可以进行加好友操作）</li>
<li>消息推送（可以利用 swoole 的异步进程实现）</li>
<li>私聊室 （加完好友即可进行私聊）</li>
<li>其余功能可以添加......</li>


</ul>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>4. 安装</h3>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>4.1 后台安装</h3>
<p>这里只是后台逻辑，前端的对应项目请移步到:&nbsp;<a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//github.com/LaravelChen/React-Small-Chat" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">https://github.com/LaravelChen/React-Small...</a></p>
<src class="highlight">
<pre><code><code class="language-text">php server start</code></code></pre>

<p>因为 swoole 常驻内存，所以一旦修改代码，需要重启。</p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>4.2 前端安装</h3>
<src class="highlight">
<pre><code><code class="language-text">npm install
npm run start</code></code></pre>

<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>5. 项目效果</h3>
<p>5.1 畅聊室</p>
<src class="RichText-gifPlaceholder">
<src class="GifPlayer" data-size="normal" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" src="./images/用Swoole+React 实现的聊天室1.jpg" alt="" data-thumbnail="./images/用Swoole+React 实现的聊天室1.jpg" data-size="normal" />

<p>5.2 私聊室</p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<src class="RichText-gifPlaceholder">
<src class="GifPlayer" data-size="normal" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" src="./images/用Swoole+React 实现的聊天室2.jpg" alt="" data-thumbnail="./images/用Swoole+React 实现的聊天室2.jpg" data-size="normal" />

<p class="ztext-empty-paragraph">&nbsp;</p>
<src class="RichText-gifPlaceholder">
<src class="GifPlayer" data-size="normal" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" src="./images/用Swoole+React 实现的聊天室3.jpg" alt="" data-thumbnail="./images/用Swoole+React 实现的聊天室3.jpg" data-size="normal" />

<p class="ztext-empty-paragraph">&nbsp;</p>
<p>此外，还有其他的加好友，消息推送等效果不演示了，可以自行下载安装使用，效果很好！</p>
<h3>6.postman 接口参考</h3>
<p><a class=" wrap external" href="https://link.zhihu.com/?target=https%3A//www.getpostman.com/collections/7f9681a60db29dfa0dce" rel="nofollow noreferrer" target="_blank" data-za-detail-view-id="1043">https://www.getpostman.com/collections/7f9...</a></p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h3>7. 数据表结构</h3>
<h3>1. 数据库名</h3>
<src class="highlight">
<pre><code><code class="language-text">swoole_framework</code></code></pre>

<h3>chat_content 表</h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">CREATE TABLE `chat_content` (
</span><span style="color: #008080;"> 2</span>   `id` int(11) unsigned NOT <span style="color: #0000ff;">NULL</span> AUTO_INCREMENT COMMENT 'id',
<span style="color: #008080;"> 3</span>   `user_id` int(11) NOT <span style="color: #0000ff;">NULL</span> COMMENT '用户id',
<span style="color: #008080;"> 4</span>   `to_user_id` int(11) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '接收方',
<span style="color: #008080;"> 5</span>   `action` enum('PUBLIC','PRIVATE') NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> 'PUBLIC' COMMENT '操作样式',
<span style="color: #008080;"> 6</span>   `chat_content` varchar(255) NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> '' COMMENT '聊天记录',
<span style="color: #008080;"> 7</span>   `created_at` datetime <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '创建时间',
<span style="color: #008080;"> 8</span>   `updated_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
<span style="color: #008080;"> 9</span>   `deleted_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '删除时间',
<span style="color: #008080;">10</span>   PRIMARY <span style="color: #008080;">KEY</span> (`id`),
<span style="color: #008080;">11</span>   <span style="color: #008080;">KEY</span> `user_id` (`user_id`,<span style="color: #000000;">`to_user_id`)
</span><span style="color: #008080;">12</span> ) ENGINE=InnoDB AUTO_INCREMENT=116 <span style="color: #0000ff;">DEFAULT</span> CHARSET=utf8mb4;</code></pre>

<p>&nbsp;</p>

<p>friends 表</p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">CREATE TABLE `friends` (
</span><span style="color: #008080;"> 2</span>   `id` int(11) unsigned NOT <span style="color: #0000ff;">NULL</span> AUTO_INCREMENT,
<span style="color: #008080;"> 3</span>   `user_id` int(11) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '用户id',
<span style="color: #008080;"> 4</span>   `to_user_id` int(11) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '好友id',
<span style="color: #008080;"> 5</span>   `created_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span>,
<span style="color: #008080;"> 6</span>   `updated_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> ON UPDATE CURRENT_TIMESTAMP,
<span style="color: #008080;"> 7</span>   `deleted_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span>,
<span style="color: #008080;"> 8</span>   PRIMARY <span style="color: #008080;">KEY</span><span style="color: #000000;"> (`id`)
</span><span style="color: #008080;"> 9</span> ) ENGINE=InnoDB AUTO_INCREMENT=13 <span style="color: #0000ff;">DEFAULT</span> CHARSET=<span style="color: #000000;">utf8;
</span><span style="color: #008080;">10</span>  </code></pre>

<p>&nbsp;</p>

<h3>notification 表</h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">CREATE TABLE `notification` (
</span><span style="color: #008080;"> 2</span>   `id` int(11) unsigned NOT <span style="color: #0000ff;">NULL</span> AUTO_INCREMENT,
<span style="color: #008080;"> 3</span>   `type` enum('ADDUSER') NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> 'ADDUSER' COMMENT '类型',
<span style="color: #008080;"> 4</span>   `action` enum('RECEIVE','REFUSE','DEFAULT') <span style="color: #0000ff;">DEFAULT</span> 'DEFAULT' COMMENT '当前的种类',
<span style="color: #008080;"> 5</span>   `user_id` int(11) NOT <span style="color: #0000ff;">NULL</span> COMMENT '发送方id',
<span style="color: #008080;"> 6</span>   `message` varchar(255) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '信息',
<span style="color: #008080;"> 7</span>   `to_user_id` int(11) NOT <span style="color: #0000ff;">NULL</span> COMMENT '接送方id',
<span style="color: #008080;"> 8</span>   `is_read` enum('YES','NO') NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> 'NO' COMMENT '是否已读',
<span style="color: #008080;"> 9</span>   `created_at` datetime NOT <span style="color: #0000ff;">NULL</span> COMMENT '创建时间',
<span style="color: #008080;">10</span>   `updated_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
<span style="color: #008080;">11</span>   `deleted_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '删除时间',
<span style="color: #008080;">12</span>   PRIMARY <span style="color: #008080;">KEY</span> (`id`),
<span style="color: #008080;">13</span>   <span style="color: #008080;">KEY</span> `type` (`type`,`user_id`,<span style="color: #000000;">`to_user_id`)
</span><span style="color: #008080;">14</span> ) ENGINE=InnoDB AUTO_INCREMENT=21 <span style="color: #0000ff;">DEFAULT</span> CHARSET=utf8mb4;</code></pre>

<p>&nbsp;</p>

<h3>users 表</h3>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #000000;">CREATE TABLE `users` (
</span><span style="color: #008080;"> 2</span>   `id` int(11) unsigned NOT <span style="color: #0000ff;">NULL</span> AUTO_INCREMENT COMMENT 'id',
<span style="color: #008080;"> 3</span>   `phone` varchar(13) NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> '' COMMENT '手机号',
<span style="color: #008080;"> 4</span>   `name` varchar(55) NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> '' COMMENT '姓名',
<span style="color: #008080;"> 5</span>   `email` varchar(30) NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> '' COMMENT '邮箱地址',
<span style="color: #008080;"> 6</span>   `avatar` varchar(255) <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '头像地址',
<span style="color: #008080;"> 7</span>   `password` varchar(100) NOT <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> '' COMMENT '密码',
<span style="color: #008080;"> 8</span>   `created_at` datetime <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT '创建时间',
<span style="color: #008080;"> 9</span>   `updated_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
<span style="color: #008080;">10</span>   `deleted_at` timestamp <span style="color: #0000ff;">NULL</span> <span style="color: #0000ff;">DEFAULT</span> <span style="color: #0000ff;">NULL</span> COMMENT ' 删除时间',
<span style="color: #008080;">11</span>   PRIMARY <span style="color: #008080;">KEY</span> (`id`),
<span style="color: #008080;">12</span>   UNIQUE <span style="color: #008080;">KEY</span> `phone` (`phone`),
<span style="color: #008080;">13</span>   UNIQUE <span style="color: #008080;">KEY</span><span style="color: #000000;"> `email` (`email`)
</span><span style="color: #008080;">14</span> ) ENGINE=InnoDB AUTO_INCREMENT=89 <span style="color: #0000ff;">DEFAULT</span> CHARSET=utf8;</code></pre>

<p>&nbsp;很<strong>多PHPer在进阶的时候总会遇到一些问题和瓶颈，业务代码写多了没有方向感，不知道该从那里入手去提升，对此我整理了一些资料，包括但不限于：分布式架构、高可扩展、高性能、高并发、服务器性能调优、TP6，laravel，YII2，Redis，Swoole、Swoft、Kafka、Mysql优化、shell脚本、Docker、微服务、Nginx等多个知识点高级进阶干货需要的可以免费分享给大家，需要的加群（点击&rarr;）<a href="https://jq.qq.com/?_wv=1027&amp;k=5kN6y8c" target="_blank">677079770</a></strong></p>


</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>