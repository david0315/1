<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®Thinkphp5ä¸QueryListï¼Œä¹Ÿå¯ä»¥å®ç°é‡‡é›†(çˆ¬è™«)é¡µé¢åŠŸèƒ½' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Thinkphp5ä¸QueryListï¼Œä¹Ÿå¯ä»¥å®ç°é‡‡é›†(çˆ¬è™«)é¡µé¢åŠŸèƒ½</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»ç¨‹åºåª›çš„æ˜å¤©æä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/a609251438/p/11889458.html</div><br>
    <h2>QueryList æ˜¯ä»€ä¹ˆ</h2>
<p>QueryListæ˜¯ä¸€å¥—ç”¨äºå†…å®¹é‡‡é›†çš„PHPå·¥å…·ï¼Œå®ƒä½¿ç”¨æ›´åŠ ç°ä»£åŒ–çš„å¼€å‘æ€æƒ³ï¼Œè¯­æ³•ç®€æ´ã€ä¼˜é›…ï¼Œå¯æ‰©å±•æ€§å¼ºã€‚ç›¸æ¯”ä¼ ç»Ÿçš„ä½¿ç”¨æ™¦æ¶©çš„æ­£åˆ™è¡¨è¾¾å¼æ¥åšé‡‡é›†ï¼ŒQueryListä½¿ç”¨äº†æ›´åŠ å¼ºå¤§è€Œä¼˜é›…çš„CSSé€‰æ‹©å™¨æ¥åšé‡‡é›†ï¼Œå¤§å¤§é™ä½äº†PHPåšé‡‡é›†çš„é—¨æ§›ï¼ŒåŒæ—¶ä¹Ÿè®©é‡‡é›†ä»£ç æ˜“è¯»æ˜“ç»´æŠ¤ï¼Œè®©ä½ ä»æ­¤å‘Šåˆ«æ™¦æ¶©éš¾æ‡‚ä¸”ä¸æ˜“ç»´æŠ¤çš„æ­£åˆ™è¡¨è¾¾å¼ğŸ˜€ã€‚</p>
<p class="ztext-empty-paragraph">&nbsp;</p>
<h2>QueryList æä¾›çš„ä¸€æ•´å¥—å†…å®¹é‡‡é›†è§£å†³æ–¹æ¡ˆ</h2>
<ul>
<li>DOMå†…å®¹é€‰æ‹©ï¼šCSSé€‰æ‹©å™¨</li>
<li>HTTPå®¢æˆ·ç«¯ï¼šGuzzleHTTP</li>
<li>å†…å®¹è¿‡æ»¤ï¼šCSSé€‰æ‹©å™¨</li>
<li>è§£å†³ä¹±ç ï¼šå†…ç½®å¤šå¥—ä¹±ç è§£å†³æ–¹æ¡ˆ</li>
<li>é¢å¤–åŠŸèƒ½ï¼šä¸°å¯Œçš„æ‰©å±•æ’ä»¶</li>
</ul>
<p class="ztext-empty-paragraph">&nbsp;</p>
<p>å‰æ</p>
<p>é¡¹ç›®ä¸»è¦ç”¨thinkphp5æ¡†æ¶ï¼Œä¸»è¦ä¼šç”¨åˆ°`QueryList.php`å’Œ`phpQuery.php`è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•ï¼Œextendé‡Œæ–°å»ºQLï¼Œç„¶ååœ¨QLç›®å½•æ‰§è¡Œcomposerå‘½ä»¤å®‰è£…QueryList:</p>
<src class="highlight">
<pre><code><code class="language-text">composer require jaeger/querylist
</code></code></pre>

<p>ç„¶ååœ¨éœ€è¦ä½¿ç”¨çš„æ§åˆ¶å™¨ä¸­åŠ å…¥ use QL\QueryList; æ¥ä¸‹æ¥å°±åœ¨æ§åˆ¶å™¨é‡Œç¼–å†™ä»£ç äº†ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå®ä¾‹</p>
<src class="highlight">
<src class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #008000;">//</span><span style="color: #008000;">éœ€è¦é‡‡é›†çš„ç›®æ ‡é¡µé¢</span>
<span style="color: #008080;"> 2</span> <span style="color: #800080;">$page</span> = 'http://cms.querylist.cc/news/566.html'<span style="color: #000000;">;
</span><span style="color: #008080;"> 3</span> <span style="color: #008000;">//</span><span style="color: #008000;">é‡‡é›†è§„åˆ™</span>
<span style="color: #008080;"> 4</span> <span style="color: #800080;">$reg</span> = <span style="color: #0000ff;">array</span><span style="color: #000000;">(
</span><span style="color: #008080;"> 5</span>    <span style="color: #008000;">//</span><span style="color: #008000;">é‡‡é›†æ–‡ç« æ ‡é¢˜</span>
<span style="color: #008080;"> 6</span>    'title' =&gt; <span style="color: #0000ff;">array</span>('h1','text'),
<span style="color: #008080;"> 7</span>    <span style="color: #008000;">//</span><span style="color: #008000;">é‡‡é›†æ–‡ç« å‘å¸ƒæ—¥æœŸ,è¿™é‡Œç”¨åˆ°äº†QueryListçš„è¿‡æ»¤åŠŸèƒ½ï¼Œè¿‡æ»¤æ‰spanæ ‡ç­¾å’Œaæ ‡ç­¾</span>
<span style="color: #008080;"> 8</span>    'date' =&gt; <span style="color: #0000ff;">array</span>('.pt_info','text','-span -a',<span style="color: #0000ff;">function</span>(<span style="color: #800080;">$content</span><span style="color: #000000;">){
</span><span style="color: #008080;"> 9</span>        <span style="color: #008000;">//</span><span style="color: #008000;">ç”¨å›è°ƒå‡½æ•°è¿›ä¸€æ­¥è¿‡æ»¤å‡ºæ—¥æœŸ</span>
<span style="color: #008080;">10</span>        <span style="color: #800080;">$arr</span> = <span style="color: #008080;">explode</span>(' ',<span style="color: #800080;">$content</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span>        <span style="color: #0000ff;">return</span> <span style="color: #800080;">$arr</span>[0<span style="color: #000000;">];
</span><span style="color: #008080;">12</span>    }),
<span style="color: #008080;">13</span>    <span style="color: #008000;">//</span><span style="color: #008000;">é‡‡é›†æ–‡ç« æ­£æ–‡å†…å®¹,åˆ©ç”¨è¿‡æ»¤åŠŸèƒ½å»æ‰æ–‡ç« ä¸­çš„è¶…é“¾æ¥ï¼Œä½†ä¿ç•™è¶…é“¾æ¥çš„æ–‡å­—ï¼Œå¹¶å»æ‰ç‰ˆæƒã€JSä»£ç ç­‰æ— ç”¨ä¿¡æ¯</span>
<span style="color: #008080;">14</span>    'content' =&gt; <span style="color: #0000ff;">array</span>('.post_content','html','a -.content_copyright -script',<span style="color: #0000ff;">function</span>(<span style="color: #800080;">$content</span><span style="color: #000000;">){
</span><span style="color: #008080;">15</span>        <span style="color: #008000;">//</span><span style="color: #008000;">åˆ©ç”¨å›è°ƒå‡½æ•°ä¸‹è½½æ–‡ç« ä¸­çš„å›¾ç‰‡å¹¶æ›¿æ¢å›¾ç‰‡è·¯å¾„ä¸ºæœ¬åœ°è·¯å¾„
</span><span style="color: #008080;">16</span> <span style="color: #008000;">       //ä½¿ç”¨æœ¬ä¾‹è¯·ç¡®ä¿å½“å‰ç›®å½•ä¸‹æœ‰imageæ–‡ä»¶å¤¹ï¼Œå¹¶æœ‰å†™å…¥æƒé™
</span><span style="color: #008080;">17</span> <span style="color: #008000;">       //ç”±äºQueryListæ˜¯åŸºäºphpQueryçš„ï¼Œæ‰€ä»¥å¯ä»¥éšæ—¶éšåœ°ä½¿ç”¨phpQueryï¼Œå½“ç„¶åœ¨è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™æˆ–è€…å…¶å®ƒæ–¹å¼è¾¾åˆ°åŒæ ·çš„ç›®çš„</span>
<span style="color: #008080;">18</span> 
<span style="color: #008080;">19</span>        <span style="color: #800080;">$doc</span>=\phpQuery::newDocumentHTML(<span style="color: #800080;">$content</span><span style="color: #000000;">);
</span><span style="color: #008080;">20</span>        <span style="color: #800080;">$imgs</span> = pq(<span style="color: #800080;">$doc</span>)-&gt;find('img'<span style="color: #000000;">);
</span><span style="color: #008080;">21</span>        <span style="color: #0000ff;">foreach</span> (<span style="color: #800080;">$imgs</span> <span style="color: #0000ff;">as</span> <span style="color: #800080;">$img</span><span style="color: #000000;">) {
</span><span style="color: #008080;">22</span>            <span style="color: #800080;">$src</span> = 'http://cms.querylist.cc'.pq(<span style="color: #800080;">$img</span>)-&gt;attr('src'<span style="color: #000000;">);
</span><span style="color: #008080;">23</span>            <span style="color: #800080;">$localSrc</span> = <span style="color: #008080;">md5</span>(<span style="color: #800080;">$src</span>).'.jpg'<span style="color: #000000;">;
</span><span style="color: #008080;">24</span>            <span style="color: #800080;">$stream</span> = <span style="color: #008080;">file_get_contents</span>(<span style="color: #800080;">$src</span><span style="color: #000000;">);
</span><span style="color: #008080;">25</span>            <span style="color: #008080;">file_put_contents</span>(<span style="color: #800080;">$localSrc</span>,<span style="color: #800080;">$stream</span><span style="color: #000000;">);
</span><span style="color: #008080;">26</span>            pq(<span style="color: #800080;">$img</span>)-&gt;attr('src',<span style="color: #800080;">$localSrc</span><span style="color: #000000;">);
</span><span style="color: #008080;">27</span> <span style="color: #000000;">       }
</span><span style="color: #008080;">28</span>        <span style="color: #0000ff;">return</span> <span style="color: #800080;">$doc</span>-&gt;<span style="color: #000000;">htmlOuter();
</span><span style="color: #008080;">29</span> <span style="color: #000000;">   })
</span><span style="color: #008080;">30</span> <span style="color: #000000;">);
</span><span style="color: #008080;">31</span> <span style="color: #800080;">$rang</span> = '.content'<span style="color: #000000;">;
</span><span style="color: #008080;">32</span> <span style="color: #800080;">$ql</span> = QueryList::Query(<span style="color: #800080;">$page</span>,<span style="color: #800080;">$reg</span>,<span style="color: #800080;">$rang</span><span style="color: #000000;">);
</span><span style="color: #008080;">33</span> <span style="color: #800080;">$data</span> = <span style="color: #800080;">$ql</span>-&gt;<span style="color: #000000;">getData();
</span><span style="color: #008080;">34</span> <span style="color: #008000;">//</span><span style="color: #008000;">æ‰“å°ç»“æœ</span>
<span style="color: #008080;">35</span> <span style="color: #008080;">print_r</span>(<span style="color: #800080;">$data</span>);</code></pre>

<p>&nbsp;</p>

<p class="ztext-empty-paragraph">&nbsp;</p>
<src class="highlight">
<pre><code><code class="language-text">æ³¨æ„ï¼šåœ¨ä½¿ç”¨phpQueryç±»æ—¶éœ€è¦åœ¨å‰é¢åŠ ä¸Š\ï¼Œå› ä¸ºphpQuery.phpä¸­æ²¡æœ‰ä½¿ç”¨å‘½åç©ºé—´ï¼Œå› ä¸ºä½¿ç”¨å‘½åç©ºé—´åï¼ŒQueryList.phpæ— æ³•ä½¿ç”¨phpQueryç±»ã€‚</code></code></pre>

<p class="ztext-empty-paragraph">&nbsp;</p>
<p>ä»¥ä¸Šæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå·²ç»å®ç°äº†é‡‡é›†ç½‘é¡µæ•°æ®ï¼Œæ›´å¤šè¯¦ç»†è¯­æ³•ä¸å®ä¾‹å¯ä»¥ç§»æ­¥åˆ°å®˜ç½‘æ–‡æ¡£ï¼Œç»†ç»†æŸ¥çœ‹</p>
<src class="highlight">
<pre><code><code class="language-text">QueryListå‚è€ƒæ–‡æ¡£ï¼šhttps://doc.querylist.cc/</code></code></pre>


</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>