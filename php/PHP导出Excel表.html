<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修PHP导出Excel表' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>PHP导出Excel表</center></div><div class='banquan'>原文出处:本文由博客园博主一隅文阁提供。<br/>
原文连接:https://www.cnblogs.com/Rxiaoyi/p/10598761.html</div><br>
    <src class="cnblogs_code">
<pre><code>&lt;?<span style="color: #000000;">php
</span><span style="color: #008000;">/*</span><span style="color: #008000;">*
 * Created by PhpStorm.
 * User: admin
 * Date: 2019/3/16
 * Time: 9:41
 </span><span style="color: #008000;">*/</span>
<span style="color: #008000;">//</span><span style="color: #008000;">利用excel导出插件PHPExcel
// 引入phpexcel核心类文件</span>
<span style="color: #0000ff;">require_once</span> 'PHPExcel.php'<span style="color: #000000;">;

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 实例化excel类</span>
<span style="color: #800080;">$objPHPExcel</span> = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PHPExcel();

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 操作第一个工作表</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;setActiveSheetIndex(0<span style="color: #000000;">);
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 设置sheet名</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setTitle('xx列表'<span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 设置表格宽度</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('A')-&gt;setWidth(10<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('B')-&gt;setWidth(20<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('C')-&gt;setWidth(15<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('D')-&gt;setWidth(50<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('E')-&gt;setWidth(20<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('F')-&gt;setWidth(5<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getColumnDimension('G')-&gt;setWidth(20<span style="color: #000000;">);


</span><span style="color: #008000;">//</span><span style="color: #008000;"> 列名表头文字加粗</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getStyle('A1:J1')-&gt;getFont()-&gt;setBold(<span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 列表头文字居中</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getStyle('A1:J1')-&gt;<span style="color: #000000;">getAlignment()
    </span>-&gt;setHorizontal(PHPExcel_Style_Alignment::<span style="color: #000000;">HORIZONTAL_CENTER);

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 列名赋值</span>
<span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('A1', '编号'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('B1', '姓名'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('C1', '电话'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('D1', '擅长'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('E1', '创建日期'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('F1', '审核'<span style="color: #000000;">);
</span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('G1', '审核时间'<span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;"> 数据起始行</span>
<span style="color: #800080;">$row_num</span> = 2<span style="color: #000000;">;
</span><span style="color: #008000;">//</span><span style="color: #008000;"> 向每行单元格插入数据
//foreach ($res as $value) {
    // 设置所有垂直居中</span>
    <span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getStyle('A' . <span style="color: #800080;">$row_num</span> . ':' . 'J' . <span style="color: #800080;">$row_num</span>)-&gt;<span style="color: #000000;">getAlignment()
        </span>-&gt;setVertical(PHPExcel_Style_Alignment::<span style="color: #000000;">VERTICAL_CENTER);
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 设置价格为数字格式</span>
    <span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getStyle('D' . <span style="color: #800080;">$row_num</span>)-&gt;<span style="color: #000000;">getNumberFormat()
        </span>-&gt;setFormatCode(PHPExcel_Style_NumberFormat::<span style="color: #000000;">FORMAT_NUMBER_00);
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 居中</span>
    <span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;getStyle('E' . <span style="color: #800080;">$row_num</span> . ':' . 'H' . <span style="color: #800080;">$row_num</span>)-&gt;<span style="color: #000000;">getAlignment()
        </span>-&gt;setHorizontal(PHPExcel_Style_Alignment::<span style="color: #000000;">HORIZONTAL_CENTER);

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> 设置单元格数值</span>
    <span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('A' . <span style="color: #800080;">$row_num</span>, 50<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('B' . <span style="color: #800080;">$row_num</span>, 'nihao'<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('C' . <span style="color: #800080;">$row_num</span>, 'sssss'<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('D' . <span style="color: #800080;">$row_num</span>, 'sssss'<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('E' . <span style="color: #800080;">$row_num</span>, 'ssssss'<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('F' . <span style="color: #800080;">$row_num</span>, 'ssssssssss'<span style="color: #000000;">);
    </span><span style="color: #800080;">$objPHPExcel</span>-&gt;getActiveSheet()-&gt;setCellValue('G' . <span style="color: #800080;">$row_num</span>, 'ssssssss'<span style="color: #000000;">);
    </span><span style="color: #800080;">$row_num</span>++<span style="color: #000000;">;
</span><span style="color: #008000;">//</span><span style="color: #008000;">}</span>

<span style="color: #800080;">$outputFileName</span> = 'teacher_' . <span style="color: #008080;">time</span>() . '.xls'<span style="color: #000000;">;
</span><span style="color: #800080;">$xlsWriter</span> = <span style="color: #0000ff;">new</span> PHPExcel_Writer_Excel5(<span style="color: #800080;">$objPHPExcel</span><span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Content-Type: application/force-download"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Content-Type: application/octet-stream"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Content-Type: application/download"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>('Content-Disposition:attachment;filename="' . <span style="color: #800080;">$outputFileName</span> . '"'<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Content-Transfer-Encoding: binary"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Expires: Mon, 26 Jul 1997 05:00:00 GMT"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Last-Modified: " . <span style="color: #008080;">gmdate</span>("D, d M Y H:i:s") . " GMT"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Cache-Control: must-revalidate, post-check=0, pre-check=0"<span style="color: #000000;">);
</span><span style="color: #008080;">header</span>("Pragma: no-cache"<span style="color: #000000;">);
</span><span style="color: #800080;">$xlsWriter</span>-&gt;save("php://output"<span style="color: #000000;">);
</span><span style="color: #008000;">//</span><span style="color: #008000;">$xlsWriter-&gt;save("php://output");

//echo file_get_contents($outputFileName);</span></code></pre>

<p>&nbsp;</p>

</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>