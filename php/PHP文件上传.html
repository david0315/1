<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修PHP文件上传' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>PHP文件上传</center></div><div class='banquan'>原文出处:本文由博客园博主行走的阳光提供。<br/>
原文连接:https://www.cnblogs.com/shineguang/p/10987291.html</div><br>
    <p><span style="font-size: 16px;"><strong>开发中需要上传图片、音乐、视频等等，这种上传传递是二进制数据。</strong></span></p>
<p><span style="font-size: 18px;"><strong>1.1客户端上传文件</strong></span></p>
<p><span style="font-size: 18px;"><strong>&nbsp; &nbsp; &nbsp; &nbsp; 文件域：</strong></span></p>
<src class="cnblogs_code">
<pre><code>&lt;input type="file" name="image"&gt;</code></pre>

<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-size: 16px;"><strong>&nbsp;表单的enctype属性：</strong></span></p>
<p><span style="font-size: 16px;"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 默认情况下，表单传递是字符流，不能传递二进制流，通过设置表单的enctype属性传递复合数据。&nbsp;</strong></span></p>
<p><span style="font-size: 16px;"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></span><strong><span style="font-size: 16px;">&nbsp;<span class="md-line md-end-block md-focus"><span class="md-expand">enctype属性的值有：</span></span></span></strong></p>
<ol class="ol-list" start="">
<li>
<p><strong><span class="md-line md-end-block" style="font-size: 16px;">application/x-www-form-urlencoded：【默认】，表示传递的是带格式的文本数据。</span></strong></p>
</li>
<li>
<p><strong><span class="md-line md-end-block" style="font-size: 16px;">multipart/form-data：复合的表单数据（字符串，文件），文件上传必须设置此值</span></strong></p>
</li>
<li><strong><span class="md-line md-end-block" style="font-size: 16px;">text/plain：用于向服务器传递无格式的文本数据，主要用户电子邮件</span></strong></li>
</ol>
<p><span style="font-size: 18px;"><strong><span class="md-line md-end-block">1.2服务器接收文件</span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span class="md-line md-end-block md-focus"><span class="md-expand">超全局变量<code>$_FILES</code>是一个二维数组，用来保存客户端上传到服务器的文件信息。二维数组的行是文件域的名称，列有5个。</span></span></span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; 1、<code>$_FILES[][&lsquo;name&rsquo;]</code>：上传的文件名</span></span></span></span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block"><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; 2、<code>$_FILES[][&lsquo;type]</code>：上传的类型，这个类型是MIME类型（image/jpeg、image/gif、image/png）</span></span></span></span></span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; 3、<code>$_FILES[][&lsquo;size&rsquo;]</code>：文件的大小，以字节为单位</span></span></span></span></span></span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; 4、<code>$_FILES[][&lsquo;tmp_name&rsquo;]</code>：文件上传时的临时文件</span></span></span></span></span></span></span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block md-focus">&nbsp; &nbsp; &nbsp; &nbsp; 5、<code>$_FILES[][&lsquo;error&rsquo;]</code>：错误编码(值有0、1、2、3、4、6、7)0表示正确</span></span></span></span></span></span></span></span></strong></span></p>
<p><span style="font-size: 18px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block md-focus"><span><span><span>1.3将上传文件移动到指定位置</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong></span></p>
<p><span style="font-size: 18px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block"><span><span><span><span class="md-line md-end-block md-focus"><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp;函数：</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong></span></p>
<src class="cnblogs_code">
<pre><code><span style="color: #008080;">move_uploaded_file</span>(临时地址,目标地址)</code></pre>

<p>&nbsp; &nbsp; <span style="font-size: 16px;"><strong>&nbsp; &nbsp; &nbsp;代码：</strong></span></p>
<src class="cnblogs_code">
<pre><code>&lt;body&gt;
&lt;?<span style="color: #000000;">php
</span><span style="color: #0000ff;">if</span>(!<span style="color: #0000ff;">empty</span>(<span style="color: #800080;">$_POST</span><span style="color: #000000;">)) {
    </span><span style="color: #0000ff;">if</span>(<span style="color: #800080;">$_FILES</span>['face']['error']==0){  <span style="color: #008000;">//</span><span style="color: #008000;">上传正确
        //文件上传</span>
        <span style="color: #008080;">move_uploaded_file</span>(<span style="color: #800080;">$_FILES</span>['face']['tmp_name'],'./'.<span style="color: #800080;">$_FILES</span>['face']['name'<span style="color: #000000;">]);
    }</span><span style="color: #0000ff;">else</span><span style="color: #000000;">{
        </span><span style="color: #0000ff;">echo</span> '上传有误'<span style="color: #000000;">;
        </span><span style="color: #0000ff;">echo</span> '错误码:'.<span style="color: #800080;">$_FILES</span>['face']['error'<span style="color: #000000;">];
    }
}
</span>?&gt;
&lt;form method="post" action="" enctype='multipart/form-data'&gt;
    &lt;input type="file" name="face"&gt;
    &lt;input type="submit" name="button" value="上传"&gt;
&lt;/form&gt;
&lt;/body&gt;</code></pre>

<p><span style="font-size: 18px;"><strong>1.4与文件上传有关的配置</strong></span><span style="font-size: 18px;"><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></span></p>
<p><span class="md-line md-end-block md-focus"><span class="md-expand">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size: 16px;"><strong>post_max_size = 8M：表单允许的最大值</strong></span></span></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upload_max_filesize = 2M：允许上传的文件大小</span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; upload_tmp_dir =F:\wamp\tmp：指定临时文件地址，如果不知道操作系统指定</span></strong></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file_uploads = On：是否允许文件上传</span></strong></span></p>
<p><span class="md-line md-end-block md-focus"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-size: 16px;"><strong>&nbsp;max_file_uploads = 20：允许同时上传20个文件</strong></span></span></span></p>
<p><span style="font-size: 16px;"><strong><span class="md-line md-end-block"><span class="md-line md-end-block md-focus"><span class="md-expand"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block"><span class="md-line md-end-block md-focus">&nbsp;</span></span></span></span></span></span></span></span></strong></span></p>

</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>