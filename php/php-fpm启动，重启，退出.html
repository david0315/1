<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修php-fpm启动，重启，退出' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>php-fpm启动，重启，退出</center></div><div class='banquan'>原文出处:本文由博客园博主自由TK提供。<br/>
原文连接:https://www.cnblogs.com/wscsq789/p/11617756.html</div><br>
    <p><span style="font-size: 15px;"><strong><span style="color: #000000;">首先确保php-fpm正常安装，运行命令php-fpm -t输出查看：</span></strong></span></p>
<p>&nbsp;</p>
<src class="cnblogs_code">
<p><span style="font-size: 15px;">##确定php-fpm配置正常<br /></span><span style="font-size: 15px;">[root@iz2vcf47jzvf8dxrapolf7z php7.<span style="color: #800080;">3.10</span>]# /usr/local/php7.<span style="color: #800080;">3.10</span>/sbin/php-fpm -<span>t<br /></span></span><span style="color: #000000;">[</span><span style="color: #800080;">02</span><span style="font-size: 15px;">-Oct-</span><span style="color: #800080;">2019</span><span style="color: #800080;">16</span><span style="font-size: 15px;">:</span><span style="color: #800080;">54</span><span style="font-size: 15px;">:</span><span style="color: #800080;">19</span><span style="font-size: 15px;">] NOTICE: configuration </span><span style="color: #0000ff;">file</span><span style="font-size: 15px;"> /usr/local/php7.</span><span style="color: #800080;">3.10</span><span style="font-size: 15px;">/etc/php-</span><span style="color: #000000;">fpm.conf test is successful</span></p>
<p><span style="font-size: 15px;">##启动php-fpm<br />[root@izj6c0ct64t9oyhoeow593z php7.3.10]# ps -ef|grep php<br /></span><span style="font-size: 15px;">root      1621  1603  0 09:31 pts/0    00:00:00 grep --color=auto php<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# /usr/local/php7.3.10/sbin/php-fpm<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# ps -ef|grep php|grep -v 'grep'<br /></span><span style="font-size: 15px;">root      1626     1  0 09:32 ?        00:00:00 php-fpm: master process (/usr/local/php7.3.10/etc/php-fpm.conf)<br /></span><span style="font-size: 15px;">www       1627  1626  0 09:32 ?        00:00:00 php-fpm: pool www<br /></span><span style="font-size: 15px;">www       1628  1626  0 09:32 ?        00:00:00 php-fpm: pool www</span></p>




<span style="font-size: 15px;">##重启php-fpm（进程ID已改变）<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# kill -SIGUSR2 `cat /usr/local/php7.3.10/var/run/php-fpm.pid`<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# ps -ef|grep php|grep -v 'grep'<br /></span><span style="font-size: 15px;">root      1651     1  0 09:36 ?        00:00:00 php-fpm: master process (/usr/local/php7.3.10/etc/php-fpm.conf)<br /></span><span style="font-size: 15px;">www       1652  1651  0 09:36 ?        00:00:00 php-fpm: pool www<br /></span><span style="font-size: 15px;">www       1653  1651  0 09:36 ?        00:00:00 php-fpm: pool www<br /><br />##关闭php-fpm进程<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# kill -SIGINT `cat /usr/local/php7.3.10/var/run/php-fpm.pid` &amp;&amp; ps -ef|grep php|grep -v 'grep'<br /></span><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# ps -ef|grep fpm<br /></span><span style="font-size: 15px;">root      1682  1603  0 09:41 pts/0    00:00:00 grep --color=auto fpm</span>
<p><span style="font-size: 15px;">&nbsp; &nbsp; &nbsp; 可以把上面命令配置到~/.bashrc文件或/etc/bashrc文件，以快捷方式执行命令。(<span style="color: #ff0000;">注意cat两端特殊字符是`不是单引号'</span>)&nbsp; &nbsp; &nbsp;&nbsp;<br /><br />&nbsp; &nbsp; &nbsp; 上面SIGUASR2和SIGINT是linux信号常量，而信号是进程在运行过程中，由自身产生或由进程外部发过来的消息（事件）。<br />&nbsp; &nbsp; &nbsp; 信号是硬件中断的软件模拟<span lang="EN-US">(软中断<span lang="EN-US">)。每个信号用一个整型常量宏表示，以<span lang="EN-US">SIG开头，比如<span lang="EN-US">SIGCHLD( 子进程结束向父进程发送的一个信号 )、<span lang="EN-US">SIGINT（Ctrl+c）等，它们在系统头文件<strong><span lang="EN-US">&lt;signal.h&gt;</span></strong>中定义<span lang="EN-US">,也可以通过在<span lang="EN-US">shell下键入<strong><span lang="EN-US">kill &ndash;l</span></strong>查看信号列表，或者键入<strong><span lang="EN-US">man 7 signal</span></strong>查看更详细的说明。<br /></span></span></span></span></span></span></span>&nbsp; &nbsp; &nbsp; 信号是系统响应某些条件而产生的一个事件，接收到该信的进程做出相应的处理。通常信是由错误产生的，如段错误(<code>SIGSEGV</code>)。 但信还可以作为进程间通信的一种方式，由一个进程发送给另一个进程。</span></p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;另外有种更便捷友好地操作方式，这里用的是centos7，可以使用systemctl</p>
<src class="cnblogs_code">
<p><span style="color: #000000; font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# vim /usr/lib/systemd/system/php-fpm.service</span></p>
<p>Description=php-fpm<br />After=syslog.target network.target</p>
<p>[Service]<br />Type=forking<br />PIDFile=/usr/local/php7.3.10/var/run/php-fpm.pid<br />ExecStart=/usr/local/php7.3.10/sbin/php-fpm<br />ExecReload=/bin/kill -SIGUSR2 MAINPID<br />ExecStop=/bin/kill &minus;SIGINT MAINPID<br />PrivateTmp=true</p>
<p>[Install]<br />WantedBy=multi-user.target<br />##让服务可用配置<br />[root@izj6c0ct64t9oyhoeow593z php7.3.10]# systemctl enable php-fpm<br />Created symlink from /etc/systemd/system/multi-user.target.wants/php-fpm.service to /usr/lib/systemd/system/php-fpm.service.</p>
<p>##重载system服务配置，使新增的php-pfm配置生效<br /><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.3.10]# systemctl daemon-reload<br />##重启fpm报错<br /></span>[root@izj6c0ct64t9oyhoeow593z php7.3.10]# systemctl reload php-fpm<br />Job for php-fpm.service invalid.<br />##查看错误原因,php-fpm还没启动<br />[root@izj6c0ct64t9oyhoeow593z php7.3.10]# systemctl status php-fpm<br />● php-fpm.service - php-fpm<br />Loaded: loaded (/usr/lib/systemd/system/php-fpm.service; disabled; vendor preset: disabled)<br />Active: inactive (dead)<br />10月 07 10:32:02 izj6c0ct64t9oyhoeow593z systemd[1]: Unit php-fpm.service cannot be reloaded because it is inactive.</p>
<p>##启动，没有提示(一般linux下没有输出就是正常的，就是好消息)<br />[root@izj6c0ct64t9oyhoeow593z php7.3.10]# systemctl start php-fpm<br />[root@izj6c0ct64t9oyhoeow593z php7.3.10]#</p>


<p><span style="font-size: 15px;">&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; 信号定义在/usr/include/asm/signal.h<em id="__mceDel" style="font-family: 'PingFang SC', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px;">文件中，以&nbsp;<code>SIG</code>&nbsp;作为开头，也可用&nbsp;<code>kill -l</code>&nbsp;命令查看，详细信息参见&nbsp;<a href="http://man7.org/linux/man-pages/man7/signal.7.html" rel="nofollow noreferrer" target="_blank">man 7 signal</a>。</em></span></p>
<src class="cnblogs_code">
<pre><code><span style="font-size: 15px;">[root@izj6c0ct64t9oyhoeow593z php7.<span style="color: #800080;">3.10</span>]# kill -<span style="color: #000000;">l
 </span><span style="color: #800080;">1</span>) SIGHUP     <span style="color: #800080;">2</span>) SIGINT     <span style="color: #800080;">3</span>) SIGQUIT     <span style="color: #800080;">4</span>) SIGILL     <span style="color: #800080;">5</span><span style="color: #000000;">) SIGTRAP
 </span><span style="color: #800080;">6</span>) SIGABRT     <span style="color: #800080;">7</span>) SIGBUS     <span style="color: #800080;">8</span>) SIGFPE     <span style="color: #800080;">9</span>) SIGKILL    <span style="color: #800080;">10</span><span style="color: #000000;">) SIGUSR1
</span><span style="color: #800080;">11</span>) SIGSEGV    <span style="color: #800080;">12</span>) SIGUSR2    <span style="color: #800080;">13</span>) SIGPIPE    <span style="color: #800080;">14</span>) SIGALRM    <span style="color: #800080;">15</span><span style="color: #000000;">) SIGTERM
</span><span style="color: #800080;">16</span>) SIGSTKFLT    <span style="color: #800080;">17</span>) SIGCHLD    <span style="color: #800080;">18</span>) SIGCONT    <span style="color: #800080;">19</span>) SIGSTOP    <span style="color: #800080;">20</span><span style="color: #000000;">) SIGTSTP
</span><span style="color: #800080;">21</span>) SIGTTIN    <span style="color: #800080;">22</span>) SIGTTOU    <span style="color: #800080;">23</span>) SIGURG    <span style="color: #800080;">24</span>) SIGXCPU    <span style="color: #800080;">25</span><span style="color: #000000;">) SIGXFSZ
</span><span style="color: #800080;">26</span>) SIGVTALRM    <span style="color: #800080;">27</span>) SIGPROF    <span style="color: #800080;">28</span>) SIGWINCH    <span style="color: #800080;">29</span>) SIGIO    <span style="color: #800080;">30</span><span style="color: #000000;">) SIGPWR
</span><span style="color: #800080;">31</span>) SIGSYS    <span style="color: #800080;">34</span>) SIGRTMIN    <span style="color: #800080;">35</span>) SIGRTMIN+<span style="color: #800080;">1</span>    <span style="color: #800080;">36</span>) SIGRTMIN+<span style="color: #800080;">2</span>    <span style="color: #800080;">37</span>) SIGRTMIN+<span style="color: #800080;">3</span>
<span style="color: #800080;">38</span>) SIGRTMIN+<span style="color: #800080;">4</span>    <span style="color: #800080;">39</span>) SIGRTMIN+<span style="color: #800080;">5</span>    <span style="color: #800080;">40</span>) SIGRTMIN+<span style="color: #800080;">6</span>    <span style="color: #800080;">41</span>) SIGRTMIN+<span style="color: #800080;">7</span>    <span style="color: #800080;">42</span>) SIGRTMIN+<span style="color: #800080;">8</span>
<span style="color: #800080;">43</span>) SIGRTMIN+<span style="color: #800080;">9</span>    <span style="color: #800080;">44</span>) SIGRTMIN+<span style="color: #800080;">10</span>    <span style="color: #800080;">45</span>) SIGRTMIN+<span style="color: #800080;">11</span>    <span style="color: #800080;">46</span>) SIGRTMIN+<span style="color: #800080;">12</span>    <span style="color: #800080;">47</span>) SIGRTMIN+<span style="color: #800080;">13</span>
<span style="color: #800080;">48</span>) SIGRTMIN+<span style="color: #800080;">14</span>    <span style="color: #800080;">49</span>) SIGRTMIN+<span style="color: #800080;">15</span>    <span style="color: #800080;">50</span>) SIGRTMAX-<span style="color: #800080;">14</span>    <span style="color: #800080;">51</span>) SIGRTMAX-<span style="color: #800080;">13</span>    <span style="color: #800080;">52</span>) SIGRTMAX-<span style="color: #800080;">12</span>
<span style="color: #800080;">53</span>) SIGRTMAX-<span style="color: #800080;">11</span>    <span style="color: #800080;">54</span>) SIGRTMAX-<span style="color: #800080;">10</span>    <span style="color: #800080;">55</span>) SIGRTMAX-<span style="color: #800080;">9</span>    <span style="color: #800080;">56</span>) SIGRTMAX-<span style="color: #800080;">8</span>    <span style="color: #800080;">57</span>) SIGRTMAX-<span style="color: #800080;">7</span>
<span style="color: #800080;">58</span>) SIGRTMAX-<span style="color: #800080;">6</span>    <span style="color: #800080;">59</span>) SIGRTMAX-<span style="color: #800080;">5</span>    <span style="color: #800080;">60</span>) SIGRTMAX-<span style="color: #800080;">4</span>    <span style="color: #800080;">61</span>) SIGRTMAX-<span style="color: #800080;">3</span>    <span style="color: #800080;">62</span>) SIGRTMAX-<span style="color: #800080;">2</span>
<span style="color: #800080;">63</span>) SIGRTMAX-<span style="color: #800080;">1</span>    <span style="color: #800080;">64</span><span style="color: #000000;">) SIGRTMAX
[root@izj6c0ct64t9oyhoeow593z php7.</span><span style="color: #800080;">3.10</span>]# cat /usr/include/asm/<span style="color: #000000;">signal.h
#ifndef _ASM_X86_SIGNAL_H
</span><span style="color: #0000ff;">#define</span> _ASM_X86_SIGNAL_H<span style="color: #000000;">

#ifndef __ASSEMBLY__
#include </span>&lt;linux/types.h&gt;<span style="color: #000000;">
#include </span>&lt;linux/time.h&gt;


<span style="color: #008000;">/*</span><span style="color: #008000;"> Avoid too many header ordering problems.  </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">struct</span><span style="color: #000000;"> siginfo;

</span><span style="color: #008000;">/*</span><span style="color: #008000;"> Here we must cater to libcs that poke about in kernel headers.  </span><span style="color: #008000;">*/</span>

<span style="color: #0000ff;">#define</span> NSIG        32<span style="color: #000000;">
typedef unsigned </span><span style="color: #0000ff;">long</span><span style="color: #000000;"> sigset_t;

</span><span style="color: #0000ff;">#endif</span> /* __ASSEMBLY__ */


<span style="color: #0000ff;">#define</span> SIGHUP         1
<span style="color: #0000ff;">#define</span> SIGINT         2
<span style="color: #0000ff;">#define</span> SIGQUIT         3
<span style="color: #0000ff;">#define</span> SIGILL         4
<span style="color: #0000ff;">#define</span> SIGTRAP         5
<span style="color: #0000ff;">#define</span> SIGABRT         6
<span style="color: #0000ff;">#define</span> SIGIOT         6
<span style="color: #0000ff;">#define</span> SIGBUS         7
<span style="color: #0000ff;">#define</span> SIGFPE         8
<span style="color: #0000ff;">#define</span> SIGKILL         9
<span style="color: #0000ff;">#define</span> SIGUSR1        10
<span style="color: #0000ff;">#define</span> SIGSEGV        11
<span style="color: #0000ff;">#define</span> SIGUSR2        12
<span style="color: #0000ff;">#define</span> SIGPIPE        13
<span style="color: #0000ff;">#define</span> SIGALRM        14
<span style="color: #0000ff;">#define</span> SIGTERM        15
<span style="color: #0000ff;">#define</span> SIGSTKFLT    16
<span style="color: #0000ff;">#define</span> SIGCHLD        17
<span style="color: #0000ff;">#define</span> SIGCONT        18
<span style="color: #0000ff;">#define</span> SIGSTOP        19
<span style="color: #0000ff;">#define</span> SIGTSTP        20
<span style="color: #0000ff;">#define</span> SIGTTIN        21
<span style="color: #0000ff;">#define</span> SIGTTOU        22
<span style="color: #0000ff;">#define</span> SIGURG        23
<span style="color: #0000ff;">#define</span> SIGXCPU        24
<span style="color: #0000ff;">#define</span> SIGXFSZ        25
<span style="color: #0000ff;">#define</span> SIGVTALRM    26
<span style="color: #0000ff;">#define</span> SIGPROF        27
<span style="color: #0000ff;">#define</span> SIGWINCH    28
<span style="color: #0000ff;">#define</span> SIGIO        29
<span style="color: #0000ff;">#define</span> SIGPOLL        SIGIO
<span style="color: #008000;">/*</span><span style="color: #008000;">
#define SIGLOST        29
</span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">#define</span> SIGPWR        30
<span style="color: #0000ff;">#define</span> SIGSYS        31
<span style="color: #0000ff;">#define</span>    SIGUNUSED    31

<span style="color: #008000;">/*</span><span style="color: #008000;"> These should not be considered constants from userland.  </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">#define</span> SIGRTMIN    32
<span style="color: #0000ff;">#define</span> SIGRTMAX    _NSIG

<span style="color: #008000;">/*</span><span style="color: #008000;">
 * SA_FLAGS values:
 *
 * SA_ONSTACK indicates that a registered stack_t will be used.
 * SA_RESTART flag to get restarting signals (which were the default long ago)
 * SA_NOCLDSTOP flag to turn off SIGCHLD when children stop.
 * SA_RESETHAND clears the handler when the signal is delivered.
 * SA_NOCLDWAIT flag on SIGCHLD to inhibit zombies.
 * SA_NODEFER prevents the current signal from being masked in the handler.
 *
 * SA_ONESHOT and SA_NOMASK are the historical Linux names for the Single
 * Unix names RESETHAND and NODEFER respectively.
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">#define</span> SA_NOCLDSTOP    0x00000001u
<span style="color: #0000ff;">#define</span> SA_NOCLDWAIT    0x00000002u
<span style="color: #0000ff;">#define</span> SA_SIGINFO    0x00000004u
<span style="color: #0000ff;">#define</span> SA_ONSTACK    0x08000000u
<span style="color: #0000ff;">#define</span> SA_RESTART    0x10000000u
<span style="color: #0000ff;">#define</span> SA_NODEFER    0x40000000u
<span style="color: #0000ff;">#define</span> SA_RESETHAND    0x80000000u

<span style="color: #0000ff;">#define</span> SA_NOMASK    SA_NODEFER
<span style="color: #0000ff;">#define</span> SA_ONESHOT    SA_RESETHAND

<span style="color: #0000ff;">#define</span> SA_RESTORER    0x04000000

<span style="color: #0000ff;">#define</span> MINSIGSTKSZ    2048
<span style="color: #0000ff;">#define</span> SIGSTKSZ    8192<span style="color: #000000;">

#include </span>&lt;asm-generic/signal-defs.h&gt;<span style="color: #000000;">

#ifndef __ASSEMBLY__


</span><span style="color: #008000;">/*</span><span style="color: #008000;"> Here we must cater to libcs that poke about in kernel headers.  </span><span style="color: #008000;">*/</span><span style="color: #000000;">
#ifdef __i386__

</span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> sigaction {
    union {
      __sighandler_t _sa_handler;
      </span><span style="color: #0000ff;">void</span> (*_sa_sigaction)(<span style="color: #0000ff;">int</span>, <span style="color: #0000ff;">struct</span> siginfo *, <span style="color: #0000ff;">void</span> *<span style="color: #000000;">);
    } _u;
    sigset_t sa_mask;
    unsigned </span><span style="color: #0000ff;">long</span><span style="color: #000000;"> sa_flags;
    </span><span style="color: #0000ff;">void</span> (*sa_restorer)(<span style="color: #0000ff;">void</span><span style="color: #000000;">);
};

</span><span style="color: #0000ff;">#define</span> sa_handler    _u._sa_handler
<span style="color: #0000ff;">#define</span> sa_sigaction    _u._sa_sigaction

<span style="color: #0000ff;">#else</span> /* __i386__ */

<span style="color: #0000ff;">struct</span><span style="color: #000000;"> sigaction {
    __sighandler_t sa_handler;
    unsigned </span><span style="color: #0000ff;">long</span><span style="color: #000000;"> sa_flags;
    __sigrestore_t sa_restorer;
    sigset_t sa_mask;        </span><span style="color: #008000;">/*</span><span style="color: #008000;"> mask last for extensibility </span><span style="color: #008000;">*/</span><span style="color: #000000;">
};

</span><span style="color: #0000ff;">#endif</span> /* !__i386__ */<span style="color: #000000;">

typedef </span><span style="color: #0000ff;">struct</span><span style="color: #000000;"> sigaltstack {
    </span><span style="color: #0000ff;">void</span> *<span style="color: #000000;">ss_sp;
    </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> ss_flags;
    size_t ss_size;
} stack_t;

</span><span style="color: #0000ff;">#endif</span> /* __ASSEMBLY__ */

<span style="color: #0000ff;">#endif</span> /* _ASM_X86_SIGNAL_H */</span></code></pre>


</div></div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>